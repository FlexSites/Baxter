{{>head}}
{{>adminHeader}}
 
<style>
    .seth {
        color: white;
    }
    .typeahead {
        padding: 0;
        margin: 0;
        position: absolute;
        z-index: 999;
    }
    .typeahead > li > a {
        display: block;
        width: 100%;
        height: 48px;
        float: left;
    }
    .typeahead > li > a > img {
        width: 48px;
        height: 48px;
        float: left;
    }
    .typeahead > li > a > p,
    .typeahead > li > a > small {
        float: left;
    }
    .typeahead > li {
        list-style-type: none;
        background: #f0f0f0;
        border-bottom: solid 1px #999;
        border-top: solid 1px #333;
        height: 48px;
    }
    .typeahead > li:hover {
        background: #fbfbfb;
    }
    #profileUpload, #heroUpload {
        background-color: #191919;
        box-shadow: inset 1px 1px 8px #000;
        text-align: center;
        position: relative;
        height: 220px;
        overflow: hidden;
    }
    #profileUpload:before, #heroUpload:before {
        position: absolute;
        top: 50%;
        left: 50%;
    }
    #profileUpload:before {
        content: "Profile Image";
        margin-left: -41px;
        margin-top: -10px;
    }
    #heroUpload:before {
        content: "Hero Image";
        margin-left: -30px;
        margin-top: -10px;
    }
    .dz-default.dz-message {
        display: none;
    }
    .dz-preview.dz-processing.dz-image-preview {
        position: relative;
    }
    .p3 {
        padding: 30px;
    }
</style>

<form name="entertainerForm" class="flex" method="post">
    <input type="hidden" name="id" value="{{entertainer.id}}" />
    <div class="p3">
        {{#entertainer.name}}
        <h1 style="margin: 32px; width: auto;">{{entertainer.name}}</h1>
        {{/entertainer.name}}
        {{^entertainer.name}}
        <lable for="name" class="grid-full">
            <input type="text" name="name" placeholder="Entertainer Name" required>
        </label>
        {{/entertainer.name}}
    </div>
    <div class="flush-full" style="padding: 30px;">
        <div class="dropzone grid-5" id="profileUpload">
            <img src="/media/entertainer/{{entertainer.slug}}/profile.jpg" id="profilePreview" class="flush-full">
            <input type="hidden" name="profileImage" id="profileValue">
        </div>
        <div class="dropzone grid-15" id="heroUpload">
            {{#entertainer.hero.externalURL}}
            <!-- Found -->
            <img src="{{entertainer.hero.externalURL}}" id="heroPreview" class="flush-full">
            <input type="hidden" name="heroImage" id="heroValue" value="{{entertainer.hero.externalURL}}">
            {{/entertainer.hero.externalURL}}
            {{^entertainer.hero.externalURL}}
            <!-- Not found -->
            <img src="/media/entertainer/{{entertainer.slug}}/hero.jpg" id="heroPreview" class="flush-full">
            <input type="hidden" name="heroImage" id="heroValue" value="/media/entertainer/{{entertainer.slug}}/hero.jpg">
            {{/entertainer.hero.externalURL}}
        </div>
        <label for="textAlign" class="grid-5 fr">
            <select name="heroTextAlign" id="textAlign" data-value="{{entertainer.hero.textAlign}}">
                <option value="left">Left
                <option value="center">Center
                <option value="right">Right
            </select>
        </label>

        <label for="isDark" class="grid-5 fr">
            <select name="heroIsDark" id="isDark" data-value="{{entertainer.hero.isDark}}">
                <option value="false">Light
                <option value="true">Dark
            </select>
        </label>
    </div>

    <div class="flush-full p3">
        <label for="description" class="grid-full">
            <textarea placeholder="Description" name="description" id="description">{{entertainer.description}}</textarea>
            <span data-errormessage="You must enter a description for the entertainer">Description</span>
        </label>
    </div>

    <div class="flush-full p3">
        <label for="video" class="grid-full">
            <input type="url" name="video" value="{{entertainer.video}}" placeholder="Video URL" id="video">
            <a href="{{entertainer.video}}" class="btn red grid-4">Watch</a>
        </label>
        <label for="facebookURL" class="grid-full">
            <input type="url" name="facebook" value="{{entertainer.facebook}}" placeholder="Facebook URL" id="facebookURL">
            <a href="{{entertainer.facebook}}" class="btn blue grid-4">Visit</a>
        </label>
        <label for="twitterURL" class="grid-full">
            <input type="url" name="twitter" value="{{entertainer.twitter}}" placeholder="Twitter URL" id="twitterURL">
            <a href="{{entertainer.twitter}}" class="btn ltblue grid-4">Visit</a>
        </label>
        <label for="entertainerLink" class="grid-full">
            <input type="text" name="link" value="{{ entertainer.link }}" id="entertainerLink" />
            <span>TicketBiscuit Link</span>
        </label>
    </div>

    <div id="actions">
        <button type="submit" class="btn">Save</button>
        <button type="submit" class="btn" name="returnTo" value="/admin/entertainer">Save & Next</button>
    </div>

</form>

{{>footer}}
<script>
$(function(){
    $(document).on('click','#profileUpload > img',function(){
        $('#profileUpload').click();
    });
    loadJS('/js/dropzone.js',function(){
        $("#profileUpload").dropzone({
            url: '/admin/entertainer/upload',
            thumbnailWidth: 220,
            thumbnailHeight: 220,
            params: {id: '{{entertainer.id}}', type: 'profile'},
            // previewTemplate: '<img class="mb r" data-dz-thumbnail>',
            //previewTemplate:'<li class="thumbnail r bs mr mb"><input type="hidden" class="imageOrder" data-dz-name><img class="mb r" data-dz-thumbnail><span data-dz-uploadprogress></span><input class="imageName"><span data-dz-errormessage></span><span data-dz-size></span></li>',
            // url: "/rcw-admin/content_manager/StoreImage.soa",
            // params: {sku: sku, name: "tempImage-"},
            init: function() {
                this.on("addedfile", function(file) {
                    console.log(file);

                    $('.dz-preview').remove();
                    // updateImages(true);
                });
            },
            success: function(file, data) {
                console.log('Success',arguments);
                $('#profilePreview').attr('src',data.image+'?v='+Math.random());
                $('#profileValue').val(data.image);
                  // this.removeFile(file);
                // $(file.previewElement).find('.imageOrder').val('tempImage-' + data.index);
                // $(file.previewElement).find('[data-dz-thumbnail]').attr('src', '/products/' + sku + '/tempImage-' + data.index + '.jpg?r=' + revision);
            },
            error: function(file, message) {
                console.log(arguments);
                // $(file.previewElement).find('[data-dz-errormessage]').addClass('error box').css('height', 'auto').text(message.errorMessage);
                // $(file.previewElement).find('.imageOrder').removeClass().removeAttr('name value');
            }
        });

        $("#heroUpload").dropzone({
            url: '/admin/entertainer/upload',
            thumbnailWidth: 680,
            thumbnailHeight: 222,
            params: {id: '{{entertainer.id}}', type: 'hero'},
            // previewTemplate: '<img class="mb r" data-dz-thumbnail>',
            //previewTemplate:'<li class="thumbnail r bs mr mb"><input type="hidden" class="imageOrder" data-dz-name><img class="mb r" data-dz-thumbnail><span data-dz-uploadprogress></span><input class="imageName"><span data-dz-errormessage></span><span data-dz-size></span></li>',
            // url: "/rcw-admin/content_manager/StoreImage.soa",
            // params: {sku: sku, name: "tempImage-"},
            init: function() {
                this.on("addedfile", function(file) {
                    console.log(file);
                    // updateImages(true);
                });
            },
            success: function(file, data) {
                console.log('Success',arguments);
                $('#heroPreview').attr('src',data.image+'?v='+Math.random());
                $('#heroValue').val(data.image);
                // $(file.previewElement).find('.imageOrder').val('tempImage-' + data.index);
                // $(file.previewElement).find('[data-dz-thumbnail]').attr('src', '/products/' + sku + '/tempImage-' + data.index + '.jpg?r=' + revision);
            },
            error: function(file, message) {
                console.log(arguments);
                // $(file.previewElement).find('[data-dz-errormessage]').addClass('error box').css('height', 'auto').text(message.errorMessage);
                // $(file.previewElement).find('.imageOrder').removeClass().removeAttr('name value');
            }
        });
    });
});
</script>
{{>foot}}